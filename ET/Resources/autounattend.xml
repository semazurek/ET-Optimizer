<?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State">
	<settings pass="offlineServicing"></settings>
	<settings pass="windowsPE">
		<component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<UserData>
				<ProductKey>
					<Key>00000-00000-00000-00000-00000</Key>
					<WillShowUI>Always</WillShowUI>
				</ProductKey>
				<AcceptEula>true</AcceptEula>
			</UserData>
			<UseConfigurationSet>false</UseConfigurationSet>
			<RunSynchronous>
				<RunSynchronousCommand wcm:action="add">
					<Order>1</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassTPMCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>2</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassSecureBootCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>3</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassRAMCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
			</RunSynchronous>
		</component>
	</settings>
	<settings pass="generalize"></settings>
	<settings pass="specialize">
		<component name="Microsoft-Windows-Deployment" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<RunSynchronous>
				<RunSynchronousCommand wcm:action="add">
					<Order>1</Order>
					<Path>powershell.exe -WindowStyle Hidden -NoProfile -Command "$xml = [xml]::new(); $xml.Load('C:\Windows\Panther\unattend.xml'); $sb = [scriptblock]::Create( $xml.unattend.Extensions.ExtractScript ); Invoke-Command -ScriptBlock $sb -ArgumentList $xml;"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>2</Order>
					<Path>powershell.exe -WindowStyle Hidden -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\Specialize.ps1' -Raw | Invoke-Expression;"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>3</Order>
					<Path>reg.exe load "HKU\DefaultUser" "C:\Users\Default\NTUSER.DAT"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>4</Order>
					<Path>powershell.exe -WindowStyle Hidden -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\DefaultUser.ps1' -Raw | Invoke-Expression;"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>5</Order>
					<Path>reg.exe unload "HKU\DefaultUser"</Path>
				</RunSynchronousCommand>
			</RunSynchronous>
		</component>
	</settings>
	<settings pass="auditSystem"></settings>
	<settings pass="auditUser"></settings>
	<settings pass="oobeSystem">
		<component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<OOBE>
				<ProtectYourPC>3</ProtectYourPC>
				<HideEULAPage>true</HideEULAPage>
				<HideWirelessSetupInOOBE>false</HideWirelessSetupInOOBE>
				<HideOnlineAccountScreens>true</HideOnlineAccountScreens>
			</OOBE>
			<FirstLogonCommands>
				<SynchronousCommand wcm:action="add">
					<Order>1</Order>
					<CommandLine>powershell.exe -WindowStyle Hidden -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\FirstLogon.ps1' -Raw | Invoke-Expression;"</CommandLine>
				</SynchronousCommand>
			</FirstLogonCommands>
		</component>
	</settings>
	<Extensions xmlns="https://schneegans.de/windows/unattend-generator/">
		<ExtractScript>
			param(
			[xml] $Document
			);

			foreach( $file in $Document.unattend.Extensions.File ) {
			$path = [System.Environment]::ExpandEnvironmentVariables( $file.GetAttribute( 'path' ) );
			mkdir -Path( $path | Split-Path -Parent ) -ErrorAction 'SilentlyContinue';
			$encoding = switch( [System.IO.Path]::GetExtension( $path ) ) {
			{ $_ -in '.ps1', '.xml' } { [System.Text.Encoding]::UTF8; }
			{ $_ -in '.reg', '.vbs', '.js' } { [System.Text.UnicodeEncoding]::new( $false, $true ); }
			default { [System.Text.Encoding]::Default; }
			};
			$bytes = $encoding.GetPreamble() + $encoding.GetBytes( $file.InnerText.Trim() );
			[System.IO.File]::WriteAllBytes( $path, $bytes );
			}
		</ExtractScript>
		<File path="C:\Windows\Setup\Scripts\RemovePackages.ps1">
			$selectors = @(
			'Microsoft.Microsoft3DViewer';
			'Microsoft.BingSearch';
			'Clipchamp.Clipchamp';
			'Microsoft.Windows.DevHome';
			'MicrosoftCorporationII.MicrosoftFamily';
			'Microsoft.WindowsFeedbackHub';
			'Microsoft.GetHelp';
			'Microsoft.Getstarted';
			'microsoft.windowscommunicationsapps';
			'Microsoft.MixedReality.Portal';
			'Microsoft.BingNews';
			'Microsoft.MicrosoftOfficeHub';
			'Microsoft.OutlookForWindows';
			'Microsoft.People';
			'Microsoft.PowerAutomateDesktop';
			'MicrosoftCorporationII.QuickAssist';
			'Microsoft.SkypeApp';
			'Microsoft.MicrosoftSolitaireCollection';
			'MicrosoftTeams';
			'MSTeams';
			'Microsoft.Todos';
			'Microsoft.WindowsSoundRecorder';
			'Microsoft.Wallet';
			'Microsoft.BingWeather';
			'Microsoft.Xbox.TCUI';
			'Microsoft.XboxApp';
			'Microsoft.XboxGameOverlay';
			'Microsoft.XboxGamingOverlay';
			'Microsoft.XboxIdentityProvider';
			'Microsoft.XboxSpeechToTextOverlay';
			'Microsoft.GamingApp';
			);
			$getCommand = {
			Get-AppxProvisionedPackage -Online;
			};
			$filterCommand = {
			$_.DisplayName -eq $selector;
			};
			$removeCommand = {
			[CmdletBinding()]
			param(
			[Parameter( Mandatory, ValueFromPipeline )]
			$InputObject
			);
			process {
			$InputObject | Remove-AppxProvisionedPackage -AllUsers -Online -ErrorAction 'Continue';
			}
			};
			$type = 'Package';
			$logfile = 'C:\Windows\Setup\Scripts\RemovePackages.log';
			&amp; {
			$installed = &amp; $getCommand;
			foreach( $selector in $selectors ) {
			$result = [ordered] @{
			Selector = $selector;
			};
			$found = $installed | Where-Object -FilterScript $filterCommand;
			if( $found ) {
			$result.Output = $found | &amp; $removeCommand;
			if( $? ) {
			$result.Message = "$type removed.";
			} else {
			$result.Message = "$type not removed.";
			$result.Error = $Error[0];
			}
			} else {
			$result.Message = "$type not installed.";
			}
			$result | ConvertTo-Json -Depth 3 -Compress;
			}
			} *&gt;&amp;1 &gt;&gt; $logfile;
		</File>
		<File path="C:\Windows\Setup\Scripts\RemoveCapabilities.ps1">
			$selectors = @(
			'Print.Fax.Scan';
			'MathRecognizer';
			'OneCoreUAP.OneSync';
			'App.Support.QuickAssist';
			'Hello.Face.18967';
			'Hello.Face.Migration.18967';
			'Hello.Face.20134';
			);
			$getCommand = {
			Get-WindowsCapability -Online | Where-Object -Property 'State' -NotIn -Value @(
			'NotPresent';
			'Removed';
			);
			};
			$filterCommand = {
			($_.Name -split '~')[0] -eq $selector;
			};
			$removeCommand = {
			[CmdletBinding()]
			param(
			[Parameter( Mandatory, ValueFromPipeline )]
			$InputObject
			);
			process {
			$InputObject | Remove-WindowsCapability -Online -ErrorAction 'Continue';
			}
			};
			$type = 'Capability';
			$logfile = 'C:\Windows\Setup\Scripts\RemoveCapabilities.log';
			&amp; {
			$installed = &amp; $getCommand;
			foreach( $selector in $selectors ) {
			$result = [ordered] @{
			Selector = $selector;
			};
			$found = $installed | Where-Object -FilterScript $filterCommand;
			if( $found ) {
			$result.Output = $found | &amp; $removeCommand;
			if( $? ) {
			$result.Message = "$type removed.";
			} else {
			$result.Message = "$type not removed.";
			$result.Error = $Error[0];
			}
			} else {
			$result.Message = "$type not installed.";
			}
			$result | ConvertTo-Json -Depth 3 -Compress;
			}
			} *&gt;&amp;1 &gt;&gt; $logfile;
		</File>
		<File path="C:\Windows\Setup\Scripts\RemoveFeatures.ps1">
			$selectors = @(
			'MediaPlayback';
			);
			$getCommand = {
			Get-WindowsOptionalFeature -Online | Where-Object -Property 'State' -NotIn -Value @(
			'Disabled';
			'DisabledWithPayloadRemoved';
			);
			};
			$filterCommand = {
			$_.FeatureName -eq $selector;
			};
			$removeCommand = {
			[CmdletBinding()]
			param(
			[Parameter( Mandatory, ValueFromPipeline )]
			$InputObject
			);
			process {
			$InputObject | Disable-WindowsOptionalFeature -Online -Remove -NoRestart -ErrorAction 'Continue';
			}
			};
			$type = 'Feature';
			$logfile = 'C:\Windows\Setup\Scripts\RemoveFeatures.log';
			&amp; {
			$installed = &amp; $getCommand;
			foreach( $selector in $selectors ) {
			$result = [ordered] @{
			Selector = $selector;
			};
			$found = $installed | Where-Object -FilterScript $filterCommand;
			if( $found ) {
			$result.Output = $found | &amp; $removeCommand;
			if( $? ) {
			$result.Message = "$type removed.";
			} else {
			$result.Message = "$type not removed.";
			$result.Error = $Error[0];
			}
			} else {
			$result.Message = "$type not installed.";
			}
			$result | ConvertTo-Json -Depth 3 -Compress;
			}
			} *&gt;&amp;1 &gt;&gt; $logfile;
		</File>
		<File path="C:\Windows\Setup\Scripts\SetStartPins.ps1">
			$json = '{"pinnedList":[]}';
			if( [System.Environment]::OSVersion.Version.Build -lt 20000 ) {
			return;
			}
			$key = 'Registry::HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Start';
			New-Item -Path $key -ItemType 'Directory' -ErrorAction 'SilentlyContinue';
			Set-ItemProperty -LiteralPath $key -Name 'ConfigureStartPins' -Value $json -Type 'String';
		</File>
		<File path="C:\Windows\Setup\Scripts\unattend-01.cmd">
			powercfg -setactive scheme_min
			powercfg -setactive e9a42b02-d5df-448d-aa00-03f14749eb61
			powercfg /S ceb6bfc7-d55c-4d56-ae37-ff264aade12d
			powercfg /X standby-timeout-ac 0
			powercfg /X standby-timeout-dc 0
			bcdedit /set timeout 3
			powercfg -hibernate off
			if exist A:\ET.exe A:\ET.exe /sillent
			if exist B:\ET.exe B:\ET.exe /sillent
			if exist C:\ET.exe C:\ET.exe /sillent
			if exist D:\ET.exe D:\ET.exe /sillent
			if exist E:\ET.exe E:\ET.exe /sillent
			if exist F:\ET.exe F:\ET.exe /sillent
			if exist G:\ET.exe G:\ET.exe /sillent
			if exist H:\ET.exe H:\ET.exe /sillent
			if exist I:\ET.exe I:\ET.exe /sillent
			if exist J:\ET.exe J:\ET.exe /sillent
			if exist K:\ET.exe K:\ET.exe /sillent
			if exist L:\ET.exe L:\ET.exe /sillent
			if exist M:\ET.exe M:\ET.exe /sillent
			if exist N:\ET.exe N:\ET.exe /sillent
			if exist X:\ET.exe X:\ET.exe /sillent
			if exist Z:\ET.exe Z:\ET.exe /sillent
			if exist Y:\ET.exe Y:\ET.exe /sillent
			if exist ET.exe ET.exe /sillent
		</File>
		<File path="C:\Windows\Setup\Scripts\Specialize.ps1">
			$scripts = @(
			{
			reg.exe add "HKLM\SYSTEM\Setup\MoSetup" /v AllowUpgradesWithUnsupportedTPMOrCPU /t REG_DWORD /d 1 /f;
			};
			{
			reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE" /v BypassNRO /t REG_DWORD /d 1 /f;
			};
			{
			start ms-cxh:localonly
			};
			{
			Remove-Item -LiteralPath 'Registry::HKLM\Software\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate' -Force -ErrorAction 'SilentlyContinue';
			};
			{
			Remove-Item -LiteralPath 'C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk', 'C:\Windows\System32\OneDriveSetup.exe', 'C:\Windows\SysWOW64\OneDriveSetup.exe' -ErrorAction 'Continue';
			};
			{
			Remove-Item -LiteralPath 'Registry::HKLM\Software\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate' -Force -ErrorAction 'SilentlyContinue';
			};
			{
			reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" /v ConfigureChatAutoInstall /t REG_DWORD /d 0 /f;
			};
			{
			Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\RemovePackages.ps1' -Raw | Invoke-Expression;
			};
			{
			Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\RemoveCapabilities.ps1' -Raw | Invoke-Expression;
			};
			{
			Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\RemoveFeatures.ps1' -Raw | Invoke-Expression;
			};
			{
			net.exe accounts /maxpwage:UNLIMITED;
			};
			{
			reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v SmartScreenEnabled /t REG_SZ /d "Off" /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v NotifyPasswordReuse /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v NotifyUnsafeApp /t REG_DWORD /d 0 /f;
			};
			{
			reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v LongPathsEnabled /t REG_DWORD /d 1 /f
			};
			{
			Set-ExecutionPolicy -Scope 'LocalMachine' -ExecutionPolicy 'RemoteSigned' -Force;
			};
			{
			fsutil.exe behavior set disableLastAccess 1;
			};
			{
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Dsh" /v AllowNewsAndInterests /t REG_DWORD /d 0 /f;
			};
			{
			reg.exe add "HKLM\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsConsumerFeatures" /t REG_DWORD /d 1 /f;
			};
			{
			reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\BitLocker" /v "PreventDeviceEncryption" /t REG_DWORD /d 1 /f;
			};
			{
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v HideFirstRunExperience /t REG_DWORD /d 1 /f;
			};
			{
			Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\SetStartPins.ps1' -Raw | Invoke-Expression;
			};
			{
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ControlAnimations" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\AnimateMinMax" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\TaskbarAnimations" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\DWMAeroPeekEnabled" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\MenuAnimation" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\TooltipAnimation" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\SelectionFade" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\DWMSaveThumbnailEnabled" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ListviewShadow" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ThumbnailsOrIcon" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ListviewAlphaSelect" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\DragFullWindows" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ComboBoxAnimation" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\FontSmoothing" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ListBoxSmoothScrolling" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\DropShadow" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
			};
			{
			reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\System" /v AllowExperimentation /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\default\System\AllowExperimentation" /v value /t REG_DWORD /d 0 /f;
			reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Start_TrackProgs /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Power\PowerThrottling" /v PowerThrottlingOff /t REG_DWORD /d 1 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v LetAppsRunInBackground /t REG_DWORD /d 2 /f;
			reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" /v GlobalUserDisabled /t REG_DWORD /d 1 /f;
			reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v BackgroundAppGlobalToggle /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v BackgroundServicesPriority /t REG_DWORD /d 10 /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v SystemResponsiveness /t REG_DWORD /d 10 /f;
			reg.exe add "HKCU\Control Panel\Accessibility\StickyKeys" /v Flags /t REG_SZ /d "506" /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v PublishUserActivities /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\WindowsStore" /v AutoDownload /t REG_DWORD /d 2 /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost" /v EnableWebContentEvaluation /t REG_DWORD /d 0 /f;
			reg.exe add "HKCU\Control Panel\International\User Profile" /v HttpAcceptLanguageOptOut /t REG_DWORD /d 1 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\MicrosoftEdge\Main" /v AllowPrelaunch /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v WalletDonationEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v CryptoWalletEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v EdgeAssetDeliveryServiceEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v DiagnosticData /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v WebWidgetAllowed /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v ShowMicrosoftRewards /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v MicrosoftEdgeInsiderPromotionEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v EdgeShoppingAssistantEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v EdgeFollowEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v EdgeCollectionsEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v AlternateErrorPagesEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v ConfigureDoNotTrack /t REG_DWORD /d 1 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v UserFeedbackAllowed /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v EdgeEnhanceImagesEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v PersonalizationReportingEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v ShowRecommendationsEnabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v HideFirstRunExperience /t REG_DWORD /d 1 /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Sensor\Permissions\{BFA794E4-F964-4FDB-90F6-51056BFE4B44}" /v SensorPermissionState /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowWiFiHotSpotReporting" /v value /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowAutoConnectToWiFiSenseHotspots" /v value /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings" /v UxOption /t REG_DWORD /d 1 /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" /v DODownloadMode /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control" /v WaitToKillServiceTimeout /t REG_SZ /d "2000" /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\default\WindowsInkWorkspace\AllowSuggestedAppsInWindowsInkWorkspace" /v value /t REG_DWORD /d 0 /f;
			reg.exe add "HKCU\Software\Microsoft\GameBar" /v AutoGameModeEnabled /t REG_DWORD /d 1 /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\PCHC" /v PreviousUninstall /t REG_DWORD /d 1 /f;
			reg.exe add "HKLM\SOFTWARE\Microsoft\PCHealthCheck" /v installed /t REG_DWORD /d 1 /f;
			reg.exe add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableTailoredExperiencesWithDiagnosticData /t REG_DWORD /d 1 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v DisabledByGroupPolicy /t REG_DWORD /d 1 /f;
			reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics" /v Value /t REG_SZ /d "Deny" /f;
			reg.exe add "HKLM\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics" /v Value /t REG_SZ /d "Deny" /f;
			reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CPSS\Store\AdvertisingInfo" /v Value /t REG_DWORD /d 0 /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\Input\TIPC" /v Enabled /t REG_DWORD /d 0 /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\InputPersonalization" /v RestrictImplicitTextCollection /t REG_DWORD /d 1 /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\InputPersonalization" /v RestrictImplicitInkCollection /t REG_DWORD /d 1 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting" /v DisableGenericReports /t REG_DWORD /d 2 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\MRT" /v DontReportInfectionInformation /t REG_DWORD /d 2 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\\Microsoft\Windows Defender\Spynet" /v LocalSettingOverrideSpynetReporting /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet" /v SpynetReporting /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet" /v SubmitSamplesConsent /t REG_DWORD /d 2 /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\Personalization\Settings" /v AcceptedPrivacyPolicy /t REG_DWORD /d 0 /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore" /v HarvestContacts /t REG_DWORD /d 0 /f;
			reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowCortana /t REG_DWORD /d 0 /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v EnableTransparency /t REG_DWORD /d 0 /f;
			reg.exe del "HKCU\Software\Microsoft\Windows\Shell\Copilot" /v CopilotLogonTelemetryTime /f;
			reg.exe del "HKCU\Software\Microsoft\Copilot" /v WakeApp /f;
			reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\Themes\Personalize" /v EnableTransparency /t REG_DWORD /d 0 /f
			};
			{
			C:\Windows\Setup\Scripts\unattend-01.cmd;
			};
			);

			&amp; {
			[float] $complete = 0;
			[float] $increment = 100 / $scripts.Count;
			foreach( $script in $scripts ) {
			Write-Progress -Activity 'Running scripts to customize your Windows installation. Do not close this window.' -PercentComplete $complete;
			&amp; $script;
			$complete += $increment;
			}
			} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\Specialize.log";
		</File>
		<File path="C:\Windows\Setup\Scripts\UserOnce.ps1">
			$scripts = @(
			{
			Get-AppxPackage -Name 'Microsoft.Windows.Ai.Copilot.Provider' | Remove-AppxPackage;
			};
			{
			Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Search' -Name 'SearchboxTaskbarMode' -Type 'DWord' -Value 1;
			};
			{
			Set-ItemProperty -LiteralPath 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name 'VisualFXSetting' -Type 'DWord' -Value 3 -Force;
			};
			);

			&amp; {
			[float] $complete = 0;
			[float] $increment = 100 / $scripts.Count;
			foreach( $script in $scripts ) {
			Write-Progress -Activity 'Running scripts to configure this user account. Do not close this window.' -PercentComplete $complete;
			&amp; $script;
			$complete += $increment;
			}
			} *&gt;&amp;1 &gt;&gt; "$env:TEMP\UserOnce.log";
		</File>
		<File path="C:\Windows\Setup\Scripts\DefaultUser.ps1">
			$scripts = @(
			{
			reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\WindowsCopilot" /v TurnOffWindowsCopilot /t REG_DWORD /d 1 /f;
			};
			{
			Remove-ItemProperty -LiteralPath 'Registry::HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Run' -Name 'OneDriveSetup' -Force -ErrorAction 'Continue';
			};
			{
			reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\GameDVR" /v AppCaptureEnabled /t REG_DWORD /d 0 /f;
			};
			{
			reg.exe add "HKU\DefaultUser\Software\Microsoft\Edge\SmartScreenEnabled" /ve /t REG_DWORD /d 0 /f;
			reg.exe add "HKU\DefaultUser\Software\Microsoft\Edge\SmartScreenPuaEnabled" /ve /t REG_DWORD /d 0 /f;
			reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\AppHost" /v EnableWebContentEvaluation /t REG_DWORD /d 0 /f;
			reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\AppHost" /v PreventOverride /t REG_DWORD /d 0 /f;
			};
			{
			$names = @(
			'ContentDeliveryAllowed';
			'FeatureManagementEnabled';
			'OEMPreInstalledAppsEnabled';
			'PreInstalledAppsEnabled';
			'PreInstalledAppsEverEnabled';
			'SilentInstalledAppsEnabled';
			'SoftLandingEnabled';
			'SubscribedContentEnabled';
			'SubscribedContent-310093Enabled';
			'SubscribedContent-338387Enabled';
			'SubscribedContent-338388Enabled';
			'SubscribedContent-338389Enabled';
			'SubscribedContent-338393Enabled';
			'SubscribedContent-353698Enabled';
			'SystemPaneSuggestionsEnabled';
			);

			foreach( $name in $names ) {
			reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v $name /t REG_DWORD /d 0 /f;
			}
			};
			{
			reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\RunOnce" /v "UnattendedSetup" /t REG_SZ /d "powershell.exe -WindowStyle Hidden -NoProfile -Command \""Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\UserOnce.ps1' -Raw | Invoke-Expression;\""" /f;
			};
			);

			&amp; {
			[float] $complete = 0;
			[float] $increment = 100 / $scripts.Count;
			foreach( $script in $scripts ) {
			Write-Progress -Activity 'Running scripts to modify the default user&#x2019;&#x2019;s registry hive. Do not close this window.' -PercentComplete $complete;
			&amp; $script;
			$complete += $increment;
			}
			} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\DefaultUser.log";
		</File>
		<File path="C:\Windows\Setup\Scripts\FirstLogon.ps1">
			$scripts = @(
			{
			cmd.exe /c "rmdir C:\Windows.old";
			cmd.exe /c "start C:\Windows\Resources\Themes\dark.theme"
			};
			{
			C:\Windows\Setup\Scripts\unattend-01.cmd;
			};
			);

			&amp; {
			[float] $complete = 0;
			[float] $increment = 100 / $scripts.Count;
			foreach( $script in $scripts ) {
			Write-Progress -Activity 'Running scripts to finalize your Windows installation. Do not close this window.' -PercentComplete $complete;
			&amp; $script;
			$complete += $increment;
			}
			} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\FirstLogon.log";
		</File>
	</Extensions>
</unattend>
